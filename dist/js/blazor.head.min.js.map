{"version":3,"file":"blazor.head.min.js","sources":["../src/ChangeTheme.ts","../src/CultureSelector.ts","../src/BlazorHead.ts"],"sourcesContent":["// ChangeTheme.ts\n\nimport type { DotNet } from '@microsoft/dotnet-js-interop'\n\nexport class ChangeTheme {\n\tprivate readonly THEME_STORAGE_NAME = 'theme'\n\tprivate readonly THEME_ATTRIBUTE = 'data-bs-theme'\n\tprivate readonly THEME_LIGHT = 'light'\n\tprivate readonly THEME_DARK = 'dark'\n\tprivate readonly THEME_AUTO = 'auto'\n\n\tprivate dotNetObjRef?: DotNet.DotNetObject\n\tprivate _darkColorScheme: MediaQueryList\n\n\tget _systemTheme(): string {\n\t\treturn this._darkColorScheme.matches ? this.THEME_DARK : this.THEME_LIGHT\n\t}\n\n\tget _storageTheme(): string | null {\n\t\treturn localStorage.getItem(this.THEME_STORAGE_NAME)\n\t}\n\n\tget _htmlTheme(): string | null {\n\t\treturn document.documentElement.getAttribute(this.THEME_ATTRIBUTE)\n\t}\n\n\tconstructor() {\n\t\tthis._darkColorScheme = window.matchMedia('(prefers-color-scheme: dark)')\n\t\tthis._keepYourEyesOnTheTheme()\n\t}\n\n\tsetReference(dotNetObjRef: DotNet.DotNetObject): void {\n\t\tthis.dotNetObjRef = dotNetObjRef\n\t}\n\n\tgetTheme(): string | null {\n\t\treturn this._storageTheme\n\t}\n\n\tsetTheme(theme: string): void {\n\t\tif (theme === this.THEME_AUTO)\n\t\t\tthis._setAllAndInvokeBlazor(theme, this._systemTheme, this.THEME_AUTO)\n\t\telse\n\t\t\tthis._setAllAndInvokeBlazor(theme, theme, theme)\n\t}\n\n\t_keepYourEyesOnTheTheme(): void {\n\t\tthis._htmlElementChanged()\n\n\t\tconst htmlElementChanged = (mutationList: MutationRecord[]) => {\n\t\t\tfor (const mutation of mutationList) {\n\t\t\t\tif (mutation.type === 'attributes' && mutation.attributeName === this.THEME_ATTRIBUTE)\n\t\t\t\t\tthis._htmlElementChanged()\n\t\t\t}\n\t\t}\n\n\t\tconst observer = new MutationObserver(htmlElementChanged)\n\t\tobserver.observe(document.documentElement, {\n\t\t\tattributes: true,\n\t\t\tchildList: false,\n\t\t\tcharacterData: false,\n\t\t})\n\n\t\tconst systemThemeChanged = async (dark: MediaQueryListEvent) => {\n\t\t\tif (dark.matches)\n\t\t\t\tawait this._systemThemeChanged(this.THEME_DARK)\n\t\t\telse\n\t\t\t\tawait this._systemThemeChanged(this.THEME_LIGHT)\n\t\t}\n\n\t\tthis._darkColorScheme.addEventListener('change', systemThemeChanged)\n\t}\n\n\t_htmlElementChanged(): void {\n\t\tif (this._storageTheme) {\n\t\t\tif (this._storageTheme === this.THEME_AUTO) {\n\t\t\t\tif (this._htmlTheme !== this._systemTheme)\n\t\t\t\t\tthis._setHtmlAndInvokeBlazor(this._systemTheme, this.THEME_AUTO)\n\t\t\t}\n\t\t\telse if (this._storageTheme !== this._htmlTheme) {\n\t\t\t\tthis._setHtmlAndInvokeBlazor(this._storageTheme, this._storageTheme)\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tthis._setAllAndInvokeBlazor(this.THEME_AUTO, this._systemTheme, this.THEME_AUTO)\n\t\t}\n\t}\n\n\tasync _systemThemeChanged(newValue: string): Promise<void> {\n\t\tif (this._storageTheme) {\n\t\t\tif (this._storageTheme === this.THEME_AUTO && this._htmlTheme !== newValue)\n\t\t\t\tawait this._setHtmlAndInvokeBlazor(newValue, this.THEME_AUTO)\n\t\t}\n\t\telse {\n\t\t\tawait this._setAllAndInvokeBlazor(this.THEME_AUTO, this._systemTheme, this.THEME_AUTO)\n\t\t}\n\t}\n\n\tasync _setHtmlAndInvokeBlazor(html: string, theme: string): Promise<void> {\n\t\tdocument.documentElement.setAttribute(this.THEME_ATTRIBUTE, html)\n\t\tawait this.dotNetObjRef?.invokeMethodAsync('OnUpdate', theme)\n\t}\n\n\tasync _setAllAndInvokeBlazor(storage: string, html: string, theme: string): Promise<void> {\n\t\tdocument.documentElement.setAttribute(this.THEME_ATTRIBUTE, html)\n\t\tlocalStorage.setItem(this.THEME_STORAGE_NAME, storage)\n\t\tawait this.dotNetObjRef?.invokeMethodAsync('OnUpdate', theme)\n\t}\n}\n","// CultureSelector.ts - Bootstrap head integration\n\nexport class CultureSelector {\n\tprivate readonly CULTURE_COOKIE_NAME = (window as any).BlazorCultureCookie\n\tprivate readonly CULTURE_STORAGE_KEY = (window as any).BlazorCultureStorage\n\tprivate readonly DEFAULT_CULTURE = 'en-US'\n\tprivate readonly RTL_CSS_ID = (window as any).BlazorRTLId ?? 'rtl-css'\n\tprivate readonly LTR_CSS_ID = (window as any).BlazorLTRId ?? 'ltr-css'\n\tprivate readonly RTL_CULTURES = [\n\t\t'ar',\n\t\t'arc',\n\t\t'dv',\n\t\t'fa',\n\t\t'ha',\n\t\t'he',\n\t\t'khw',\n\t\t'ks',\n\t\t'ku',\n\t\t'ps',\n\t\t'ur',\n\t\t'yi',\n\t\t'ug',\n\t\t'sd',\n\t\t'prs',\n\t\t'az',\n\t\t'nqo',\n\t\t'rhg',\n\t\t'syr',\n\t\t'ff',\n\t]\n\n\tprivate _currentCulture: string\n\n\tget _browserCulture(): string {\n\t\treturn navigator.language || this.DEFAULT_CULTURE\n\t}\n\n\tget _cookieCulture(): string | null {\n\t\tconst cookieValue = this._getCookie(this.CULTURE_COOKIE_NAME)\n\t\tif (!cookieValue)\n\t\t\treturn null\n\n\t\ttry {\n\t\t\t// Dekoding: \"c%3Dhu%7Cuic%3Dhu\" → \"c=hu|uic=hu\"\n\t\t\tconst decoded = decodeURIComponent(cookieValue)\n\t\t\t// \"c=hu|uic=hu\" → \"hu\"\n\t\t\tconst match = decoded.match(/c=([^|]+)/)\n\t\t\treturn match ? match[1] : null\n\t\t}\n\t\tcatch {\n\t\t\treturn null\n\t\t}\n\t}\n\n\tget _storageCulture(): string | null {\n\t\tconst storageValue = localStorage.getItem(this.CULTURE_STORAGE_KEY)\n\t\tif (!storageValue)\n\t\t\treturn null\n\n\t\ttry {\n\t\t\t// Same format as cookie: \"c=hu|uic=hu\" → \"hu\"\n\t\t\tconst match = storageValue.match(/c=([^|]+)/)\n\t\t\treturn match ? match[1] : null\n\t\t}\n\t\tcatch {\n\t\t\treturn null\n\t\t}\n\t}\n\n\tconstructor() {\n\t\tif (this.CULTURE_STORAGE_KEY) {\n\t\t\t// Storage mode\n\t\t\tthis._currentCulture = this._storageCulture || this._browserCulture\n\t\t\tthis._setStorage(this._currentCulture)\n\t\t}\n\t\telse {\n\t\t\t// Cookie mode (original logic)\n\t\t\tthis._currentCulture = this._cookieCulture || this._browserCulture\n\t\t\tthis._setCookie(this._currentCulture)\n\t\t}\n\n\t\t// Global variable for Blazor.start()\n\t\t;(window as any).BlazorCulture = this._currentCulture\n\n\t\t// HTML lang and dir attributes setting + CSS activation\n\t\tthis._setHtmlAttributes(this._currentCulture)\n\t}\n\n\tgetCookie(): string {\n\t\treturn this._currentCulture\n\t}\n\n\tsetCookie(culture: string): void {\n\t\tif (culture === this._currentCulture)\n\t\t\treturn\n\n\t\tthis._currentCulture = culture\n\n\t\tif (this.CULTURE_STORAGE_KEY) {\n\t\t\tthis._setStorage(culture)\n\t\t}\n\t\telse {\n\t\t\tthis._setCookie(culture)\n\t\t}\n\n\t\t;(window as any).BlazorCulture = culture\n\t}\n\n\tgetStorage(): string {\n\t\treturn this._currentCulture\n\t}\n\n\tsetStorage(culture: string): void {\n\t\tif (culture === this._currentCulture)\n\t\t\treturn\n\n\t\tthis._currentCulture = culture\n\n\t\tif (this.CULTURE_STORAGE_KEY) {\n\t\t\tthis._setStorage(culture)\n\t\t}\n\t\telse {\n\t\t\tthis._setCookie(culture)\n\t\t}\n\n\t\t;(window as any).BlazorCulture = culture\n\t}\n\n\tprivate _setHtmlAttributes(culture: string): void {\n\t\t// <html lang=\"hu\"> or <html lang=\"en-US\">\n\t\tdocument.documentElement.setAttribute('lang', culture)\n\n\t\t// <html dir=\"rtl\"> or <html dir=\"ltr\">\n\t\tconst langCode = culture.split('-')[0]\n\t\tconst isRtl = this.RTL_CULTURES.includes(langCode)\n\t\tdocument.documentElement.setAttribute('dir', isRtl ? 'rtl' : 'ltr')\n\n\t\t// CSS activation\n\t\tconst cssLink = document.getElementById(isRtl ? this.RTL_CSS_ID : this.LTR_CSS_ID) as HTMLLinkElement\n\t\tif (cssLink) {\n\t\t\tcssLink.disabled = false\n\t\t}\n\t}\n\n\tprivate _setStorage(culture: string): void {\n\t\t// ASP.NET RequestCulture format: \"c=hu|uic=hu\"\n\t\tconst cultureValue = `c=${culture}|uic=${culture}`\n\t\tlocalStorage.setItem(this.CULTURE_STORAGE_KEY, cultureValue)\n\t}\n\n\tprivate _setCookie(culture: string): void {\n\t\t// ASP.NET RequestCulture format: \"c=hu|uic=hu\"\n\t\tconst cookieValue = `c=${culture}|uic=${culture}`\n\t\tconst encodedValue = encodeURIComponent(cookieValue)\n\n\t\tdocument.cookie = `${this.CULTURE_COOKIE_NAME}=${encodedValue}`\n\t}\n\n\tprivate _getCookie(name: string): string | null {\n\t\tconst nameEQ = `${name}=`\n\t\tconst cookies = document.cookie.split(';')\n\n\t\tfor (let cookie of cookies) {\n\t\t\tcookie = cookie.trim()\n\t\t\tif (cookie.indexOf(nameEQ) === 0) {\n\t\t\t\treturn cookie.substring(nameEQ.length)\n\t\t\t}\n\t\t}\n\t\treturn null\n\t}\n}\n","import { ChangeTheme } from './ChangeTheme.js'\nimport { CultureSelector } from './CultureSelector.js'\n\nexport class BlazorHead {\n\tChangeTheme: ChangeTheme\n\tCultureSelector: CultureSelector\n\tconstructor() {\n\t\tthis.ChangeTheme = new ChangeTheme()\n\t\tthis.CultureSelector = new CultureSelector()\n\t}\n}\n\n(window as any).BlazorHead = new BlazorHead()\n"],"names":["n","a","i","e","t","s","ChangeTheme","__publicField","dotNetObjRef","theme","htmlElementChanged","mutationList","mutation","systemThemeChanged","dark","newValue","html","storage","u","o","CultureSelector","cookieValue","match","storageValue","culture","langCode","isRtl","cssLink","cultureValue","encodedValue","name","nameEQ","cookies","cookie","l","r","BlazorHead"],"mappings":"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"}